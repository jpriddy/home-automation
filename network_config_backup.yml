---
- name: Backup all network configurations
  hosts: all
  tasks:

  - name: "Backup of routeros hosts"
    community.routeros.command:
        commands: 
        - /system backup dont-encrypt=yes save name file=[identity]-[date]-[time].backup
    #when: ansible_network_os == 'community.network.routeros'

  - name: "Starting configuration backup of routeros hosts"
    community.routeros.command:
        commands: 
        - /export show-sensitive file=[identity]-[date]-[time].config_export
    #when: ansible_network_os == 'community.network.routeros'
          

          [
#getting timeout errors, perhaps its a permissions issue with the automount?
#  - name: "Grabbing backup file and storing in backup folder(s) on synology"
#    ansible.netcommon.net_get:
#        src: "{{inventory_hostname}}.backup"
#        dest: "/synology/backup/config_backups/{{inventory_hostname}}.backup"
#
#  - name: "Grabbing rsc file aand storing in backup folder(s) on synology"
#    ansible.netcommon.net_get:
#        src: "{{inventory_hostname}}.rsc"
#        dest: "/synology/backup/config_backups/{{inventory_hostname}}.rsc"
